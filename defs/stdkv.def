;key-value type
{
	(include "stdvarspace.def")
	(include "llkv.def")

	;Definition of Linked list form
	;@vari(name) : "linkedlist"

	(def 'llbase (base) (+ base stdVSsize))

	;Key Value entry
	;Note: keys can only be 20 bytes maximum
	;@(+ vari(name) (+ (* key (EXP 0x100 3)) (EXP 0x100 2)) : mainvalue
	;+1 : Previous Entry
	;+2 : Next Entry

	;---------------------------------------------------------------------------------------------

	(def 'IkvCTS (base key) (+ base (+ (EXP 0x100 2) (* (MOD key (EXP 0x100 20)) (EXP 0x100 3)))))

	(def 'IkvInit (base name addperm rmperm modperm)
		{
			[[base]]"keyvalue"
			[[(IvnSlot base)]]name
			[[(IvapSlot base)]]addperm
			[[(IvrpSlot base)]]rmperm
			[[(IvmpSlot base)]]modperm
		}
	)

	(def 'IkvSet (slot value) (llkvSet slot 0 value))

	(def 'IkvStore (slot mem membool)
		{
			(if membool
				(IkvSet slot @mem)
				(IkvSet slot (calldataload mem))
			)
		}
	)
	(def 'IkvGet (slot) (llkvGet slot 0))
	(def 'IkvLoad (slot mem) (llkvLoad slot 0 mem))


	;Externals
	;-------------------------------------------------------------
	(def 'kvCTS (name key) (IkvCTS (vari name) key))

	(def 'kvInit (name addperm rmperm modperm) (IkvInit (vari name) name addperm rmperm modperm))

	(def 'kvGet (name key) (IkvGet (kvCTS name key)))
	(def 'kvLoad (name key mem) (IkvLoad (kvCTS name key) mem))

	(def 'kvSet (name key value) (IkvSet (kvCTS name key) value))
	(def 'kvStore (name key mem membool) (IkvStore (kvCTS name key) mem membool))
}